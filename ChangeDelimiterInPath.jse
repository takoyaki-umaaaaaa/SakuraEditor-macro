// Sakura editor macro
// パス名の区切り文字変換

try{
	// 選択済み文字列取得 + 選択済みかチェック
	var selectedStr = Editor.GetSelectedString(0);
	if( selectedStr < 1 ){
		var e = new Error(0, "変換したい文字列を選択後に\r\nマクロを呼び出してください。");
		throw e;
	}

	
	// \ ➔ \\	： /\\/g, '\\\\'
	// \ ➔ /	： /\\/g, '/'
	// \\ ➔ \	： /\\\\/g, '\\'
	// / ➔ \\	： /\/g, '\\\\'
	selectedStr = selectedStr.replace( /\\/g, '\\\\' );

	// 文書に出力
	Editor.InsText( selectedStr );
}
catch( e ) {
	Editor.InfoMsg( e.description );
}
